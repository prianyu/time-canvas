!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).TimeCanvas=e()}(this,function(){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function t(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function e(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=o(n);return s(this,i?(t=o(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function u(t){return t<10?"0".concat(t):t}var l=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]],c=["h:i:s","h:i","i:s","s"],h=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"canvas",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r(this,n),this.options=Object.assign({colors:["#33B5E5","#0099CC","#AA66CC","#9933CC","#99CC00","#669900","#FFBB33","#FF8800","#FF4444","#CC0000"],color:"#0081FF",width:320,height:200,center:!0,middle:!0,padding:20,size:0,ballCount:300,format:c[0]},e),this.id=t||"canvas",this._balls=[];t=document.getElementById(this.id);t.width=this.options.width,t.height=this.options.height,this.context=t.getContext("2d"),c.includes(this.options.format)||(this.options.format=c[0])}return t(n,[{key:"_play",value:function(){var t=this;this._clearTimer(),this._timer=setInterval(function(){t._render(),t._update()},50)}},{key:"_pause",value:function(t){var e=this;this._timer&&(this._clearTimer(),!0!==t&&(this._timer=setInterval(function(){e._render(),e._updateBalls()},50)))}},{key:"_destroy",value:function(){var t=this.options,e=t.width,t=t.height;this._clearTimer(),this.context.clearRect(0,0,e,t),this._balls=[]}},{key:"_render",value:function(){var t=this.options,e=t.width,n=t.height,i=this._renderDigit.bind(this),t=this.context,r=this._getRenderData(this._currentTime);this._rect=this._getRect(r);var o=this._rect.top;t.clearRect(0,0,e,n);for(var a=0;a<r.length;a++)i(this._getOffset(r,a),o,r[a]);this._renderBalls()}},{key:"_update",value:function(){var t=this.getCurrentTime(),e=this._getRenderData(t),n=this._getRenderData(this._currentTime),i=this._rect.top;if(this._emit("change",t),e.join("")!=n.join("")){for(var r=0;r<n.length;r++)e[r]!=n[r]&&this._addBall(this._getOffset(n,r),i,n[r]);this._currentTime=t}this._updateBalls()}},{key:"_getRenderData",value:function(){}},{key:"_renderBalls",value:function(){for(var t=this._balls,e=this._rect.radius,n=this.context,i=0;i<t.length;i++)n.fillStyle=t[i].color,n.beginPath(),n.arc(t[i].x,t[i].y,e,0,2*Math.PI,!0),n.closePath(),n.fill()}},{key:"_renderDigit",value:function(t,e,n){var i=this.context,r=this._rect.radius,o=r+1;n=":"===n?10:parseInt(n),i.fillStyle=this.options.color;for(var a=0;a<l[n].length;a++)for(var s=0;s<l[n][a].length;s++)1==l[n][a][s]&&(i.beginPath(),i.arc(t+o+2*s*o,e+o+2*a*o,r,0,2*Math.PI),i.closePath(),i.fill())}},{key:"_addBall",value:function(t,e,n){for(var i=this._rect.radius+1,r=this.options.colors,o=0;o<l[n].length;o++)for(var a,s=0;s<l[n][o].length;s++)1==l[n][o][s]&&(a={x:t+2*s*i+i,y:e+2*o*i+i,g:1.5+Math.random(),vx:5*Math.pow(-1,Math.ceil(1e3*Math.random())),vy:-5,color:r[Math.floor(Math.random()*r.length)]},this._balls.push(a))}},{key:"_updateBalls",value:function(){}},{key:"_getRenderBalls",value:function(){for(var t=this.options,e=t.width,n=t.height,i=this._balls,r=this._rect.radius,o=0;o<i.length;o++)i[o].x+=i[o].vx,i[o].y+=i[o].vy,i[o].vy+=i[o].g,i[o].y>=n-r?(i[o].y=n-r,i[o].vy=.75*-i[o].vy):i[o].x>=e-r&&(i[o].x=e-r,i[o].vx=3*-i[o].vx);for(var a=0,s=0;s<i.length;s++)0<i[s].x+r&&i[s].x-r<e&&(i[a++]=i[s]);for(;i.length>Math.min(this.options.ballCount,a);)i.pop();return a}},{key:"_getOffset",value:function(t,e){for(var n=this._rect.left,i=this._rect.radius+1,r=0;r<=e;r++){var o=t[r-1];o&&(n+=(":"===o?9:15)*i)}return n}},{key:"_getRect",value:function(t){for(var e=this.options,n=e.width,i=e.height,r=e.padding,o=e.size,a=e.center,e=e.middle,n=n-2*r,i=i-2*r,s=0,u=0;u<t.length;u++)":"!==t[u]?(s+=14,t[u+1]&&":"!==t[u+1]&&(s+=2)):s+=9;return o=o?o/14-1:n/s-1,o=Math.max(1,o),{left:a?r+n/2-s/2*(o+1):r,top:e?r+i/2-10*(o+1):r,radius:o}}},{key:"_clearTimer",value:function(){clearInterval(this._timer),this._timer=null}},{key:"_emit",value:function(t){t=this.options[t];if("function"==typeof t){for(var e=arguments.length,n=new Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return t.apply(void 0,n)}}}]),n}();return function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(i,h);var n=e(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"canvas",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r(this,i),(e=n.call(this,t,e))._init(),s(e,e._getInstance())}return t(i,[{key:"_getInstance",value:function(){var e=this,n={};return["pause","play","getCurrentTime","destroy"].map(function(t){n[t]=e[t].bind(e)}),n}},{key:"_init",value:function(){this.play(),this._emit("init",this._currentTime)}},{key:"getCurrentTime",value:function(){var t=new Date;return{hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),milliseconds:t.getMilliseconds(),now:t}}},{key:"play",value:function(){return this._currentTime||(this._currentTime=this.getCurrentTime()),this._play()}},{key:"pause",value:function(t){return this._pause(t)}},{key:"destroy",value:function(){return this._destroy()}},{key:"_getRenderData",value:function(t){var e=t.hours,n=t.minutes,t=t.seconds;return this.options.format.replace("h",u(e)).replace("i",u(n)).replace("s",u(t)).split("")}},{key:"_updateBalls",value:function(){this._getRenderBalls()}}]),i}()});